{
  "hash": "4183ed519498f117496d454509da1b54",
  "result": {
    "markdown": "---\ntitle: \"Blog Post 7\"\nauthor: \"Yating Zhu, Dingyu Guo, Suh Edwin Jiho, Wang Muxi\"\ndate: \"2024-04-19\"\ndate-modified: \"2024-04-19\"\ndraft: FALSE\n---\n\n::: {.cell}\n\n:::\n\n\n# Time series model\n\n::: {.cell}\n\n:::\n\n\n- Fit a time series model using data from 2000 to 2022. \n- \n## Summary table \n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 7\n   nobs sigma   logLik      AIC      BIC deviance df.residual\n  <int> <dbl>    <dbl>    <dbl>    <dbl>    <dbl>       <int>\n1 93672  587. -730079. 1460170. 1460226. 1460158.       93666\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  effect   group    term            estimate std.error statistic\n  <chr>    <chr>    <chr>              <dbl>     <dbl>     <dbl>\n1 fixed    <NA>     (Intercept)       667.      68.6        9.72\n2 fixed    <NA>     ROOMS              79.4      1.04      76.3 \n3 fixed    <NA>     NFAMS              89.3      2.93      30.4 \n4 fixed    <NA>     AGE                -2.08     0.109    -19.2 \n5 ran_pars REGION   sd__(Intercept)   204.      NA         NA   \n6 ran_pars Residual sd__Observation   587.      NA         NA   \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 16\n  RENTGRS ROOMS NFAMS   AGE REGION .fitted .resid      .hat .cooksd .fixed   .mu\n    <dbl> <dbl> <dbl> <dbl>  <dbl>   <dbl>  <dbl>     <dbl>   <dbl>  <dbl> <dbl>\n1    2300     3     1    93     21    634.  1666. 0.000176  3.55e-4   800.  634.\n2     355     5     1    62     22    778.  -423. 0.000208  2.70e-5  1024.  778.\n3    3160     3     1    31     12   1114.  2046. 0.0000897 2.73e-4   930. 1114.\n4     210     4     1    53     22    717.  -507. 0.000201  3.76e-5   963.  717.\n5     253     3     1    63     31    910.  -657. 0.0000785 2.46e-5   863.  910.\n6     610     5     1    22     32    839.  -229. 0.000227  8.66e-6  1107.  839.\n# ℹ 5 more variables: .offset <dbl>, .sqrtXwt <dbl>, .sqrtrwt <dbl>,\n#   .weights <dbl>, .wtres <dbl>\n```\n:::\n:::\n\n## Residual plot \n\n::: {.cell}\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n- The linear mixed-effects model assesses the impact of rooms, family size, and age on rent prices.\n- Random effects account for region-based variations.\n- The model summary indicates the significance and impact of each factor on rent prices.\n- The residual plot reveals:\n  1) Residuals are widely dispersed around zero, suggesting no systematic bias in the model.\n  2) Some outliers are present, which could be anomalies.\n- The time series plot of fitted values shows:\n  1) Fluctuating average fitted rent values over the years.\n  2) An increasing trend in rent prices up to 2015.\n  3) A post-2015 sharp decline in average fitted rent values.\n- Potential causes for trends:\n  1) Pre-2015 rise could relate to inflation, market demand, or changes in building age, room number, and family size.\n  2) The decline after 2015 might reflect economic events, policy changes, or factors outside the model's scope.\n\n\n\n<<<<<<< HEAD\n\n\n\n\n\n\n=======\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_twenty$INCTOT <- scale(data_twenty$INCTOT, center = TRUE, scale = TRUE)\ndata_twenty$ROOMS <- scale(data_twenty$ROOMS, center = TRUE, scale = TRUE)\ndata_twenty$NFAMS <- scale(data_twenty$NFAMS, center = TRUE, scale = TRUE)\ndata_twenty$AGE <- scale(data_twenty$AGE, center = TRUE, scale = TRUE)\ndata_twenty$FTOTINC <- scale(data_twenty$FTOTINC, center = TRUE, scale = TRUE)\n\nmodel_with_income <- lmer(RENTGRS ~ INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + RACE + EMPSTAT + FTOTINC + (1 | REGION_CLASSIFIED), data = data_twenty, REML = FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_glance <- broom.mixed::glance(model)\n\nmodel_tidy <- broom.mixed::tidy(model)\n\nmodel_augment <- broom.mixed::augment(model)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(model_glance)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 7\n   nobs sigma   logLik      AIC      BIC deviance df.residual\n  <int> <dbl>    <dbl>    <dbl>    <dbl>    <dbl>       <int>\n1 93672  587. -730079. 1460170. 1460226. 1460158.       93666\n```\n:::\n\n```{.r .cell-code}\nprint(model_tidy)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  effect   group    term            estimate std.error statistic\n  <chr>    <chr>    <chr>              <dbl>     <dbl>     <dbl>\n1 fixed    <NA>     (Intercept)       667.      68.6        9.72\n2 fixed    <NA>     ROOMS              79.4      1.04      76.3 \n3 fixed    <NA>     NFAMS              89.3      2.93      30.4 \n4 fixed    <NA>     AGE                -2.08     0.109    -19.2 \n5 ran_pars REGION   sd__(Intercept)   204.      NA         NA   \n6 ran_pars Residual sd__Observation   587.      NA         NA   \n```\n:::\n\n```{.r .cell-code}\nprint(head(model_augment))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 16\n  RENTGRS ROOMS NFAMS   AGE REGION .fitted .resid      .hat .cooksd .fixed   .mu\n    <dbl> <dbl> <dbl> <dbl>  <dbl>   <dbl>  <dbl>     <dbl>   <dbl>  <dbl> <dbl>\n1    2300     3     1    93     21    634.  1666. 0.000176  3.55e-4   800.  634.\n2     355     5     1    62     22    778.  -423. 0.000208  2.70e-5  1024.  778.\n3    3160     3     1    31     12   1114.  2046. 0.0000897 2.73e-4   930. 1114.\n4     210     4     1    53     22    717.  -507. 0.000201  3.76e-5   963.  717.\n5     253     3     1    63     31    910.  -657. 0.0000785 2.46e-5   863.  910.\n6     610     5     1    22     32    839.  -229. 0.000227  8.66e-6  1107.  839.\n# ℹ 5 more variables: .offset <dbl>, .sqrtXwt <dbl>, .sqrtrwt <dbl>,\n#   .weights <dbl>, .wtres <dbl>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate residuals and fitted values\nresiduals_twenty <- resid(model_with_income)\nfitted_values_twenty <- fitted(model_with_income)\n\n# Create a residual plot\nplot(fitted_values_twenty, residuals_twenty, \n     xlab = \"Fitted Values\", ylab = \"Residuals\",\n     main = \"Residual Plot\", pch = 20)\nabline(h = 0, col = \"red\") \n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter out non-positive values before log transformation\ndata_twenty <- data_twenty[data_twenty$RENTGRS > 0 & data_twenty$INCTOT > 0, ]\n\n# Apply log transformation\ndata_twenty$log_RENTGRS <- log(data_twenty$RENTGRS)\ndata_twenty$log_INCTOT <- log(data_twenty$INCTOT)\n\n\n# Calculating means and standard deviations for the log-transformed columns\nmean_log_RENTGRS <- mean(data_twenty$log_RENTGRS, na.rm = TRUE)\nsd_log_RENTGRS <- sd(data_twenty$log_RENTGRS, na.rm = TRUE)\nmean_log_INCTOT <- mean(data_twenty$log_INCTOT, na.rm = TRUE)\nsd_log_INCTOT <- sd(data_twenty$log_INCTOT, na.rm = TRUE)\n\n\n# Defining lower and upper bounds for both variables\nlb_log_RENTGRS <- mean_log_RENTGRS - 3 * sd_log_RENTGRS\nub_log_RENTGRS <- mean_log_RENTGRS + 3 * sd_log_RENTGRS\nlb_log_INCTOT <- mean_log_INCTOT - 3 * sd_log_INCTOT\nub_log_INCTOT <- mean_log_INCTOT + 3 * sd_log_INCTOT\n\n# Filtering out outliers\ndata_twenty_clean <- data_twenty[data_twenty$log_RENTGRS >= lb_log_RENTGRS & data_twenty$log_RENTGRS <= ub_log_RENTGRS & \n                             data_twenty$log_INCTOT >= lb_log_INCTOT & data_twenty$log_INCTOT <= ub_log_INCTOT, ]\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n### Residual plot\n\n::: {.cell}\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n>>>>>>> 82db39764d3811eb02dffd7471ef187a724fd74e\n\n\n\n",
    "supporting": [
      "blog-post-7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}