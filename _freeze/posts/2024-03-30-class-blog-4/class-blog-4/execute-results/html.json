{
  "hash": "e9f9e8e250130b06cd66fd05e3856201",
  "result": {
    "markdown": "---\ntitle: \"Class blog 4\"\nauthor: \"\"\ndate: \"2024-03-30\"\ndate-modified: \"2024-03-30\"\ndraft: FALSE\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nhere() starts at /Users/yating/Desktop/Final Project MA415\n```\n:::\n\n```{.r .cell-code}\ndata_path <- here(\"dataset\", \"rent_income_clean.csv\")\nlibrary(readr)\nrent_clean_data <- read_csv(data_path,show_col_types = FALSE) \nlibrary(ggplot2)\n```\n:::\n\n\n## Roughly see the relationship between income and rent \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(rent_clean_data, aes(x = INCTOT, y = RENTGRS)) +\n  geom_point(color = 'black', alpha = 0.1)\n```\n\n::: {.cell-output-display}\n![](class-blog-4_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n-The horizontal axis represents the total income (INCTOT), which is the predictor.\n-The vertical axis represents the rent paid (RENTGRS), which is the response.\n-The purpose of creating this scatter plot is to assess whether there is a linear or non-linear relationship between total income and rent paid in a general way. \n-The density of the points can be seen with a darker shade, indicating a higher concentration of data points. There seems to be a large concentration of points towards the lower end of the income scale with lower rents, which suggests that a significant portion of the dataset includes individuals with lower income and rent levels.\n-The plot does not clearly show a distinct linear trend, suggesting that the relationship between these variables might be non-linear \n\n## Simple linear model \n\n::: {.cell}\n\n```{.r .cell-code}\nlm_model <- lm(RENTGRS ~ INCTOT, data = rent_clean_data)\ntidy_lm <- tidy(lm_model)\nprint(tidy_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 5\n  term          estimate std.error statistic p.value\n  <chr>            <dbl>     <dbl>     <dbl>   <dbl>\n1 (Intercept) 1366.      1.45           943.       0\n2 INCTOT         0.00554 0.0000220      252.       0\n```\n:::\n\n```{.r .cell-code}\nglance_lm <- glance(lm_model)\nprint(glance_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic p.value    df    logLik     AIC    BIC\n      <dbl>         <dbl> <dbl>     <dbl>   <dbl> <dbl>     <dbl>   <dbl>  <dbl>\n1    0.0955        0.0955  916.    63312.       0     1 -4941285.  9.88e6 9.88e6\n# ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n:::\n\n```{.r .cell-code}\naugmented_data <- augment(lm_model)\nprint(augmented_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 599,745 × 8\n   RENTGRS INCTOT .fitted  .resid       .hat .sigma      .cooksd .std.resid\n     <dbl>  <dbl>   <dbl>   <dbl>      <dbl>  <dbl>        <dbl>      <dbl>\n 1     913  46000   1621.  -708.  0.00000170   916. 0.000000509     -0.773 \n 2     913  20000   1477.  -564.  0.00000186   916. 0.000000352     -0.616 \n 3     630  15000   1449.  -819.  0.00000197   916. 0.000000790     -0.894 \n 4     300  16400   1457. -1157.  0.00000194   916. 0.00000155      -1.26  \n 5    1430  88000   1853.  -423.  0.00000311   916. 0.000000332     -0.462 \n 6    1652   6000   1399.   253.  0.00000226   916. 0.0000000860     0.276 \n 7    1652   3000   1383.   269.  0.00000238   916. 0.000000103      0.294 \n 8    1652   4000   1388.   264.  0.00000234   916. 0.0000000968     0.288 \n 9    2113 120300   2032.    80.7 0.00000557   916. 0.0000000216     0.0881\n10     813      0   1366.  -553.  0.00000250   916. 0.000000457     -0.604 \n# ℹ 599,735 more rows\n```\n:::\n:::\n\n- The R-squared value is 0.094855, which means that approximately 9.49% of the variability in the rent paid (RENTGRS) can be explained by the total income (INCTOT). This is a relatively low R-squared value, indicating that the linear model does not explain a large portion of the variability in the rent.But it is fair, because we only include one predictor here.\n- The statistic value is 63312.15, which is extremely high. This suggests that the overall significance of the model is strong, despite the low R-squared. This could be due to a large sample size, which can make even small relationships appear statistically significant.\n\n### Residual plot\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(augmented_data, aes(x = .fitted, y = .resid)) +\n  geom_point(aes(color = INCTOT), alpha = 0.5) + \n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +\n  labs(x = \"Fitted Values\", y = \"Residuals\", \n       title = \"Residuals vs. Fitted Values\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](class-blog-4_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n- This diagram indicates that the spread of residuals appears to increase as the fitted values increase. This pattern indicates heteroscedasticity, which means that the variability of the residuals is not constant across levels of the predictor variable. In an ideal scenario, I'd want to see a consistent spread of residuals across all levels of fitted values, suggesting homoscedasticity.\n\n## Multiple linear regression\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ensure categorical variables are treated as factors\nrent_clean_data$KITCHEN <- as.factor(rent_clean_data$KITCHEN)\nrent_clean_data$MARST <- as.factor(rent_clean_data$MARST)\nrent_clean_data$RACE <- as.factor(rent_clean_data$RACE)\nrent_clean_data$EMPSTAT <- as.factor(rent_clean_data$EMPSTAT)\n\n# Fit the regression model with dummy variables for categorical factors\nmlr_model <- lm(RENTGRS ~ INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + RACE + EMPSTAT + FTOTINC, data = rent_clean_data)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy_mlr <- tidy(mlr_model)\nprint(tidy_mlr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 22 × 5\n   term           estimate  std.error statistic   p.value\n   <chr>             <dbl>      <dbl>     <dbl>     <dbl>\n 1 (Intercept) 1020.       11.3           90.6  0        \n 2 INCTOT         0.000565  0.0000308     18.3  7.68e- 75\n 3 KITCHEN4    -136.        9.82         -13.9  1.12e- 43\n 4 ROOMS         53.0       0.562         94.3  0        \n 5 NFAMS        171.        1.45         118.   0        \n 6 AGE           -1.73      0.0794       -21.8  5.47e-105\n 7 MARST2       -65.7       7.24          -9.07 1.18e- 19\n 8 MARST3      -170.        6.80         -25.0  1.96e-137\n 9 MARST4      -189.        3.67         -51.5  0        \n10 MARST5       -58.9       5.55         -10.6  2.82e- 26\n# ℹ 12 more rows\n```\n:::\n\n```{.r .cell-code}\nglance_mlr <- glance(mlr_model)\nprint(glance_mlr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic p.value    df    logLik     AIC    BIC\n      <dbl>         <dbl> <dbl>     <dbl>   <dbl> <dbl>     <dbl>   <dbl>  <dbl>\n1     0.244         0.244  837.     9239.       0    21 -4887330.  9.77e6 9.77e6\n# ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n:::\n\n```{.r .cell-code}\naugmented_mlr <- augment(mlr_model)\nprint(augmented_mlr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 599,745 × 16\n   RENTGRS INCTOT KITCHEN ROOMS NFAMS   AGE MARST RACE  EMPSTAT FTOTINC .fitted\n     <dbl>  <dbl> <fct>   <dbl> <dbl> <dbl> <fct> <fct> <fct>     <dbl>   <dbl>\n 1     913  46000 4           5     1    24 1     1     1         66000   1613.\n 2     913  20000 4           5     1    22 1     1     1         66000   1602.\n 3     630  15000 4           4     1    27 6     1     1         15000   1234.\n 4     300  16400 4           4     1    59 6     1     3         16400   1163.\n 5    1430  88000 4           4     1    37 6     2     1         88000   1498.\n 6    1652   6000 4           4     3    21 6     1     1          6000   1539.\n 7    1652   3000 4           4     3    21 6     1     1          3000   1523.\n 8    1652   4000 4           4     3    20 6     1     3          4000   1508.\n 9    2113 120300 4           6     1    35 2     1     1        120300   1878.\n10     813      0 4           6     1    30 1     1     3         32000   1448.\n# ℹ 599,735 more rows\n# ℹ 5 more variables: .resid <dbl>, .hat <dbl>, .sigma <dbl>, .cooksd <dbl>,\n#   .std.resid <dbl>\n```\n:::\n:::\n\n- The R-squared value is 0.2444284, indicating that about 24.44% of the variability in the dependent variable is explained by the model. This is a significant improvement over the simple linear model previously discussed, suggesting that including more variables helps explain the variance in the dependent variable more effectively.\n-  The adjusted R-squared value is 0.2444019, which is very close to the R-squared value.Since the adjusted R-squared is almost identical to the R-squared, this implies that the additional predictors are indeed contributing valuable information.\n-  The statistic value is 9238.626, which is very high and the p-value is 0, indicating that the model is statistically significant. It means that the likelihood of the regression results being due to chance is extremely low. \n\n#### Multicollinearity concerns\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n```{.r .cell-code}\nvif_values <- vif(mlr_model)\nprint(vif_values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            GVIF Df GVIF^(1/(2*Df))\nINCTOT  2.350435  1        1.533113\nKITCHEN 1.018471  1        1.009193\nROOMS   1.096575  1        1.047175\nNFAMS   1.090520  1        1.044280\nAGE     1.857354  1        1.362848\nMARST   1.854721  5        1.063721\nRACE    1.092614  8        1.005551\nEMPSTAT 1.354703  2        1.078850\nFTOTINC 2.279910  1        1.509937\n```\n:::\n:::\n\nThrough the result, INCTOT (Total Income) and FTOTINC (Family Total Income) stand out as having higher multicollinearity indicators than the others. While considering the what constitutes the Family total income, it is fair multicollinearity happens. So we decide to exclude the FTOTINC in our model. With a GVIF^(1/(2*Df)) value of approximately 1.53 and FTOTINC is about 1.51, a VIF between 1 and 5 suggests moderate indication of multicollinearity.\n\n#### Residual plot:\nHeterskedasticity still exits. \n\n\n\n## solution: 1.take log? ---  as both response and predictor right skewed\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(rent_clean_data, aes(x = log(RENTGRS))) +\n  geom_histogram(binwidth = 0.1, fill = \"blue\", color = \"black\") + \n  labs(title = \"Distribution of Log of Monthly Gross Rent\",\n       x = \"Log of Monthly Gross Rent\",\n       y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](class-blog-4_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n# distribution after log income \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(rent_clean_data, aes(x = log(INCTOT))) +\n  geom_histogram(bins = 100, fill = \"blue\", color = \"black\") + # Keep the number of bins or adjust as needed\n  theme_minimal() +\n  labs(title = \"Histogram of Log of Total Personal Income\",\n       x = \"Log of Total Personal Income\",\n       y = \"Frequency\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in log(INCTOT): NaNs produced\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 70886 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](class-blog-4_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## 2: Merged data \nWe consolidated datasets spanning 22 years, from 1990 to 2022, sourced from the same repositories. The approach to cleaning and processing these datasets was aligned with the methodology applied to the 2022 dataset, as previously detailed.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ lubridate 1.9.3     ✔ tibble    3.2.1\n✔ purrr     1.0.2     ✔ tidyr     1.3.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n✖ car::recode()   masks dplyr::recode()\n✖ purrr::some()   masks car::some()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(here)\nlibrary(dplyr)\ndata_path <- here(\"dataset-ignore\", \"twenty_yr_data.csv\")\nlibrary(readr)\ntwentyyr_data <- read_csv(data_path,show_col_types = FALSE)\nprint(head(twentyyr_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 15\n   YEAR REGION RENTGRS KITCHEN ROOMS NFAMS   AGE MARST  RACE RACED EMPSTAT\n  <dbl>  <dbl>   <dbl>   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>\n1  2000     21       0       4     7     1    66     5     1   100       1\n2  2000     21       0       4     7     1    40     6     1   100       1\n3  2000     33       0       4     5     1    51     1     1   100       1\n4  2000     33       0       4     5     1    48     1     1   100       3\n5  2000     33       0       4     5     1    19     6     1   100       1\n6  2000     33       0       4     5     1    17     6     1   100       3\n# ℹ 4 more variables: EMPSTATD <dbl>, INCTOT <dbl>, FTOTINC <dbl>,\n#   POVERTY <dbl>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nset.seed(123) # Setting a seed for reproducibility\ntwentyyr_data_clean <- sample_frac(twentyyr_data, 0.01)\ntwentyyr_data_clean <- twentyyr_data_clean %>%\n  filter(RENTGRS != 0,  # Exclude entries with zero rent\n         !is.na(RENTGRS),  # Exclude NA values for rent\n         EMPSTAT %in% c(\"1\", \"2\", \"3\"),  # Include only valid employment statuses\n         KITCHEN != \"0\",  # Exclude entries without a kitchen\n         ROOMS != \"00\",  # Exclude entries with invalid room counts\n         !INCTOT %in% c(1, 9999999, 9999998, -1),  # Exclude specific INCTOT values\n         !FTOTINC %in% c(9999998, 9999999),  # Exclude specific FTOTINC values\n         POVERTY != 0,  # Exclude invalid poverty codes\n         !REGION %in% c(91, 92, 97, 99))  # Exclude specific region/state codes\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_csv(twentyyr_data_clean, file = here(\"dataset\", \"twentyyear_rent.csv\"))\nsaveRDS(twentyyr_data_clean, file = here(\"dataset\", \"twentyyear_rent.rds\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntwentyyr_data_clean$REGION_CLASSIFIED <- case_when(\n  twentyyr_data_clean$REGION %in% c(11, 12, 13) ~ \"NORTHEAST\",\n  twentyyr_data_clean$REGION %in% c(21, 22, 23) ~ \"MIDWEST\",\n  twentyyr_data_clean$REGION %in% c(31, 32, 33, 34) ~ \"SOUTH\",\n  twentyyr_data_clean$REGION %in% c(41, 42, 43) ~ \"WEST\",\n  TRUE ~ \"OTHER\"\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#KITCHEN\ntwentyyr_data_clean <- twentyyr_data_clean %>%\n  mutate(KITCHEN = case_when(\n    KITCHEN == \"0\" ~ \"N/A\",\n    KITCHEN == \"1\" ~ \"No\",\n    KITCHEN == \"2\" ~ \"No, or shared use\",\n    KITCHEN == \"3\" ~ \"Yes, shared use\",\n    KITCHEN == \"4\" ~ \"Yes (shared or exclusive use)\",\n    KITCHEN == \"5\" ~ \"Yes, exclusive use\",\n    TRUE ~ as.character(KITCHEN)\n  ))\ntwentyyr_data_clean$KITCHEN <- as.factor(twentyyr_data_clean$KITCHEN)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#MARST\ntwentyyr_data_clean <- twentyyr_data_clean %>%\n  mutate(MARST = case_when(\n    MARST == \"1\" ~ \"Married, spouse present\",\n    MARST == \"2\" ~ \"Married, spouse absent\",\n    MARST == \"3\" ~ \"Separated\",\n    MARST == \"4\" ~ \"Divorced\",\n    MARST == \"5\" ~ \"Widowed\",\n    MARST == \"6\" ~ \"Never married/single\",\n    MARST == \"9\" ~ \"Blank, missing\",\n    TRUE ~ as.character(MARST)\n  ))\ntwentyyr_data_clean$MARST <- as.factor(twentyyr_data_clean$MARST)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#RACE\ntwentyyr_data_clean <- twentyyr_data_clean %>%\n  mutate(RACE = case_when(\n    RACE == \"1\" ~ \"White\",\n    RACE == \"2\" ~ \"Black/African American\",\n    RACE == \"3\" ~ \"American Indian or Alaska Native\",\n    RACE == \"4\" ~ \"Chinese\",\n    RACE == \"5\" ~ \"Japanese\",\n    RACE == \"6\" ~ \"Other Asian or Pacific Islander\",\n    RACE == \"7\" ~ \"Other race, nec\",\n    RACE == \"8\" ~ \"Two major races\",\n    RACE == \"9\" ~ \"Three or more major races\",\n    TRUE ~ as.character(RACE) \n  ))\ntwentyyr_data_clean$RACE <- as.factor(twentyyr_data_clean$RACE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#EMPSTAT\ntwentyyr_data_clean <- twentyyr_data_clean %>%\n  mutate(EMPSTAT = case_when(\n    EMPSTAT == \"1\" ~ \"Employed\",\n    EMPSTAT == \"2\" ~ \"Unemployed\",\n    EMPSTAT == \"3\" ~ \"Not in labour force\",\n    TRUE ~ as.character(EMPSTAT) \n  ))\n\ntwentyyr_data_clean$EMPSTAT <- as.factor(twentyyr_data_clean$EMPSTAT)\n```\n:::\n\n\n#### 1. extract 2022 dataset 2. take log of rentgrs and inctot and delete outliner +/- 3SD 3. lm()\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extracting the 2022 data\n# If the correct column name is 'Year' or 'YEAR', use that instead:\ndata_2022 <- twentyyr_data_clean[twentyyr_data_clean$YEAR == 2022, ]\n\n\n# Filter out non-positive values before log transformation\ndata_2022 <- data_2022[data_2022$RENTGRS > 0 & data_2022$INCTOT > 0, ]\n\n# Apply log transformation\ndata_2022$log_RENTGRS <- log(data_2022$RENTGRS)\ndata_2022$log_INCTOT <- log(data_2022$INCTOT)\n\n# Calculating means and standard deviations for the log-transformed columns\nmean_log_RENTGRS <- mean(data_2022$log_RENTGRS, na.rm = TRUE)\nsd_log_RENTGRS <- sd(data_2022$log_RENTGRS, na.rm = TRUE)\nmean_log_INCTOT <- mean(data_2022$log_INCTOT, na.rm = TRUE)\nsd_log_INCTOT <- sd(data_2022$log_INCTOT, na.rm = TRUE)\n\n\n# Defining lower and upper bounds for both variables\nlb_log_RENTGRS <- mean_log_RENTGRS - 3 * sd_log_RENTGRS\nub_log_RENTGRS <- mean_log_RENTGRS + 3 * sd_log_RENTGRS\nlb_log_INCTOT <- mean_log_INCTOT - 3 * sd_log_INCTOT\nub_log_INCTOT <- mean_log_INCTOT + 3 * sd_log_INCTOT\n\n# Filtering out outliers\ndata_2022_clean <- data_2022[data_2022$log_RENTGRS >= lb_log_RENTGRS & data_2022$log_RENTGRS <= ub_log_RENTGRS & \n                             data_2022$log_INCTOT >= lb_log_INCTOT & data_2022$log_INCTOT <= ub_log_INCTOT, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the multiple linear regression model with the additional predictors\nmlr_model_2022 <- lm(log_RENTGRS ~ log_INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + RACE + EMPSTAT, data = data_2022_clean)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate residuals and fitted values\nresiduals_2022 <- resid(mlr_model_2022)\nfitted_values_2022 <- fitted(mlr_model_2022)\n\n# Create a residual plot\nplot(fitted_values_2022, residuals_2022, \n     xlab = \"Fitted Values\", ylab = \"Residuals\",\n     main = \"Residual Plot\", pch = 20)\nabline(h = 0, col = \"red\") # Adds a horizontal line at 0\n```\n\n::: {.cell-output-display}\n![](class-blog-4_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### Twenty years trend\n\n::: {.cell}\n\n```{.r .cell-code}\nmedian_twentyyr_data_clean <- twentyyr_data_clean %>%\n  group_by(YEAR, REGION_CLASSIFIED) %>%\n  summarize(median_rent = median(RENTGRS, na.rm = TRUE), .groups = 'drop') %>%\n  ungroup()\n\nggplot(median_twentyyr_data_clean, aes(x = YEAR, y = median_rent, color = REGION_CLASSIFIED)) +\n  geom_line() + \n  geom_point() + \n  theme_minimal() + \n  labs(title = \"Change of Median Rent by Year\",\n       x = \"Year\",\n       y = \"Median Rent\") +\n  scale_x_continuous(breaks = unique(median_twentyyr_data_clean$YEAR))+\n  theme(axis.text.x = element_text(size = 5)) \n```\n\n::: {.cell-output-display}\n![](class-blog-4_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n#### regreesion \n\n\n\n\n\n\n\n",
    "supporting": [
      "class-blog-4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}