---
title: "Analysis"
description: "Here we provide a detailed analysis using more sophisticated statistics techniques."
toc: true
draft: FALSE
---
![](images/AnalysisPicture.png)
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyr)
library(broom)
library(dplyr)
library(here)
library(gt)
library(purrr)

library(readr)
library(ggplot2)
library(knitr)
library(lme4)
library(broom.mixed)
library(nlme)
library(car)

data_path <- here("dataset", "data_twenty_clean.csv")
data_path1 <- here("dataset", "latest_clean.csv")

data_twenty <- read_csv(data_path,show_col_types = FALSE) 
data_2022 <- read_csv(data_path1,show_col_types = FALSE) 

```

# Research Question and Motivation

## Motivation

The primary focus of this research is to investigate the relationship between individual income levels and rental expenditures. This analysis is motivated by the need to understand the financial burdens of rent relative to income and how this impacts different demographic groups over time.

## Objectives

-   **Relationship Exploration**: We aim to determine how changes in income levels affect rental spending. This includes examining whether the relationship is strictly linear or if there are nonlinear dynamics that better capture the fluctuations in rental expenditures as income varies.
-   **Quantitative Analysis**: Our goal is to quantify the relationship precisely. For example, we seek to estimate the increase in rental expenditure for every thousand-dollar increase in income or the percentage change of rent expenditure for every one percent increase in income.
-   **Demographic Variance**: The study will also consider racial differences to identify how income's impact on rent varies among different racial groups.
-   **Temporal Analysis**: Employing a time series regression model allows us to account for changes over time, providing a dynamic perspective on the income-rent relationship.


# Models and Inferences (First dataset)

## Outline of models used in class blogs

1.  Simple Linear Regression Model (Detailed in Class Blog 4)
- Investigates the relationship between income (the predictor) and rent (the response), offering preliminary insights into whether they share a positive or negative correlation and assessing if it is worth to have further detailed analysis.

2.  Multiple Linear Regression Model (Detailed in Class Blog 4)

3.  Log-Log Regression Model

4.  Log-Log Regression Model with interaction terms


## 2. Multiple Linear Regression Model

### Model Overview:

-   This model enhances the simple linear regression by incorporating additional confounding variables to refine our analysis.
-   This expanded model builds upon the initial simple linear regression framework.

### Model Findings:

[Click here to view the summary table, which includes estimates, standard errors, statistics, and p-values for each coefficient.](https://yatingzhu.shinyapps.io/app1/)

- A $1,000 increase in total income (INCTOT) is associated with an average increase of 5.2 in gross rent (RENTGRS), assuming other variables are constant.

### Statistical Performance:
```{r echo=FALSE, message=FALSE, warning=FALSE}
 mlr_model <- lm(RENTGRS ~ INCTOT + ROOMS + NFAMS + AGE + MARST + RACE + EMPSTAT + REGION_CLASSIFIED, data = data_2022)
glance_mlr=glance(mlr_model)
kable(glance_mlr)
```
-   The R-squared value of 0.28 indicates that approximately 28% of the variance in the dependent variable (gross rent) is explained by the model, which is a considerable improvement compared to the simple linear regression.

-   A F-statistic value of 98.57 and a p-value of 0 confirm the statistical significance of the model, suggesting that the regression results are highly unlikely to occur by chance.

### Variable Selection and model refinement:
-   A correlation matrix was used to identify control variables and to detect potential multi-collinearity issues.

```{r echo=FALSE, message=FALSE, warning=FALSE}
data_2022$KITCHEN <- as.factor(data_2022$KITCHEN)
data_2022$MARST <- as.factor(data_2022$MARST)
data_2022$RACE <- as.factor(data_2022$RACE)
data_2022$EMPSTAT <- as.factor(data_2022$EMPSTAT)
data_2022$REGION_CLASSIFIED <- as.factor(data_2022$REGION_CLASSIFIED)
cor_matrix <- cor(data_2022[, c("INCTOT", "ROOMS", "NFAMS", "AGE", "FTOTINC", "RENTGRS")])
kable(cor_matrix, format = "pipe")
```
-   A review of multicollinearity prompted the removal of `FTOTINC` to prevent model overfitting.

```{r echo=FALSE, message=FALSE, warning=FALSE}
mlr_model <- lm(RENTGRS ~ INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + RACE + EMPSTAT + FTOTINC + REGION_CLASSIFIED, data = data_2022)
library(car)
vif_values <- vif(mlr_model)
kable(vif_values)
```
-   After fitting the multiple linear regression (MLR) model, `Kitchen` was removed due to its statistical insignificance, indicated by a high p-value.
-   `Employment Status`, although not as critical, also showed a non-significant p-value and is suspected to interact with variables like `Income` or `FTOTINC`. This interaction will be explored further.


### Model Discussion :
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Fit the model
residuals <- resid(mlr_model)
fitted_values <- fitted(mlr_model)

plot(fitted_values, residuals,
     xlab = "Fitted Values",
     ylab = "Residuals",
     main = "Residual Plot of mlr_model",
     pch = 20)

abline(h = 0, col = "red")
```
- The plot indicates a potential non-linear relationship and heteroscedasticity, evident from the increase in variability with the size of the fitted values.

- Some points notably deviate from the main cluster, particularly in the bottom left and top right, suggesting they could be potential outliers or leverage points. 

## 3. Log-Log Regression Model

### Model Overview:
-   Predictor and response variables underwent log transformation to correct for right skewness, as elaborated on the data page and the discussion in last section.

-   A reanalysis was conducted post data cleansing to assess the impact of log-transformed variables.

### Model Findings:

```{r echo=FALSE, message=FALSE, warning=FALSE}
log_model_2022 <- lm(log_RENTGRS ~ log_INCTOT + ROOMS + NFAMS + AGE + MARST + RACE + EMPSTAT + REGION_CLASSIFIED, data = data_2022)
```

[Click here to view the summary table, which includes estimates, standard errors, statistics, and p-values for each coefficient.]( https://yatingzhu.shinyapps.io/app2/)

- The model suggests that a 10% increase in income is predicted to raise rent by an average of 13.34%, with all other variables held constant, indicating income's elasticity effect on rent.

### Statistical Performance:
```{r echo=FALSE, message=FALSE, warning=FALSE}
glance_log=glance(log_model_2022)
kable(glance_log)
```
-   An adjusted R-squared value of 0.223, while modest, is considered adequate within the complex realms of social science and economics.

-   A very low p-value signifies the statistical significance of the model’s predictors.

-   The sigma value's reduction points to a more precise model, albeit comparisons with non-logarithmic models are not straightforward due to scale differences.

### Model Discussion :
1.  Linearity and Homoscedasticity:
```{r echo=FALSE, message=FALSE, warning=FALSE}
plot(fitted(log_model_2022), residuals(log_model_2022),
     xlab = "Fitted values",
     ylab = "Residuals",
     main = "Residuals vs. Fitted Values")
abline(h = 0, col = "red")
```

- The residuals show no systematic pattern, indicating an effective capture of the relationship between predictors and response variable. 

- While the spread is mostly consistent, some widening at the extremes suggests minor heteroscedasticity, typical in economic data involving higher income or rent brackets, but it does not significantly compromise the model's validity. Residuals predominantly center around the zero line, indicating no model bias and reinforcing its accuracy. 

- A few potential outliers, common in large economic datasets, do not notably affect the robust central trend captured by the model.

2.  Normality of Residuals:

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Q-Q plot of residuals
qqnorm(residuals(log_model_2022))
qqline(residuals(log_model_2022), col = "steelblue")
```

-   The bulk of residuals align with the normality line on the Q-Q plot, with slight deviations at both ends, which is often seen in economic data due to outliers, do not substantially affect the model’s predictive capability.

3.  IID Errors:

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(lmtest)
test <- dwtest(log_model_2022)
kable(tibble::as_tibble(list(
  Statistic = test$statistic,
  p_Value = test$p.value
)), caption = "Durbin-Watson Test Results")
```

-   For Durbin-Watson Statistic, the result statistic value close to 2 indicates no autocorrelation, implying that the errors are independent. And for a random scatter of residuals, without visible trends or cycles, supports the assumption of IID errors.

4.  Multicollinearity:

```{r echo=FALSE, message=FALSE, warning=FALSE}
index=vif(log_model_2022)
kable(index)
```

-   The adjusted GVIF values, being all near or below the threshold of 1.5 after taking the root, demonstrate that the multicollinearity is likely not distorting the estimates in the regression model significantly. This implies that each predictor variable is providing unique information that is not overly redundant with other variables in the model.

**Upon reviewing these diagnostic measures, the model is deemed well-fitted, and the derived conclusions are robust and reliable.**

## 4. Log-Log Regression Model by Race

### Model Overview

-   This analysis applies a stratified Log-Log regression approach, segregating data by race . It builds upon the foundational understanding from Section 3.

### Model Findings:

```{r echo=FALSE, message=FALSE, warning=FALSE}
categorical_vars <- c("KITCHEN", "MARST", "EMPSTAT", "REGION_CLASSIFIED")
data_2022[categorical_vars] <- lapply(data_2022[categorical_vars], factor)
categorical_vars <- c("KITCHEN", "MARST", "EMPSTAT", "REGION_CLASSIFIED")
data_2022[categorical_vars] <- lapply(data_2022[categorical_vars], factor)
race_levels <- data_2022 %>%
  group_by(RACE) %>%
  summarize(across(all_of(categorical_vars), ~n_distinct(.))) %>%
  ungroup()
races_with_single_levels <- race_levels %>%
  filter(if_any(everything(), ~.x == 1)) %>%
  pull(RACE) 
data_2022_filtered <- data_2022 %>%
  filter(!RACE %in% races_with_single_levels)

models_by_race <- data_2022_filtered%>%
  group_by(RACE) %>%
  do(
    model = lm(log_RENTGRS ~ log_INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + EMPSTAT + REGION_CLASSIFIED, data = .)
  )

models_summaries <- models_by_race %>%
  rowwise() %>%
  do(
    tidy_model = broom::tidy(.$model)
  )
unnested_models_summaries <- tidyr::unnest(models_summaries, tidy_model)

inctot_coefficients_by_race <- models_by_race %>%
  rowwise() %>%
  summarize(
    RACE = unique(RACE),
    log_INCTOT_Coefficient = coef(model)["log_INCTOT"]
  )
kable(inctot_coefficients_by_race)
```

-   The coefficient for log_INCTOT shows notable variation across racial categories, which indicates the impact of income on rent varies by race.

  -   The Chinese group demonstrates the highest log_INCTOT coefficient, indicating a particularly strong positive association between income and rent within this demographic.

  -   American Indian or Alaska Native, Other Asian or Pacific Islander, Other race, nec, Three or more major races, and White categories show a range of coefficients, suggesting varied levels of positive association.

  -   Black/African American and Two major races groups present with lower coefficients, hinting at a relatively weaker positive relationship.

### Statistical Performance:

```{r echo=FALSE, message=FALSE, warning=FALSE}
models_summaries <- data_2022_filtered %>%
  group_by(RACE) %>%
  do(
    tidy_model = broom::tidy(lm(log_RENTGRS ~ log_INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + EMPSTAT + REGION_CLASSIFIED, data = .))
  ) %>%
  unnest(tidy_model) %>%
  filter(term == "log_INCTOT") %>%
  select(RACE, term, estimate, p.value) %>%
  arrange(RACE)
kable(models_summaries)
```

-   For most racial groups, the p-values indicate statistical significance (p \< 0.05), especially pronounced for `Black/African American`, `Chinese`, `Other Asian or Pacific Islander`, and `White categories`, implying a strong relationship between income and rent.

-   But the higher p-value for some groups suggests that the relationship between income and rent is **not statistically significant** .

### Model Discussion:

-   The evident variability in log_INCTOT coefficients across races suggests that the relationship between income and rent is influenced by racial factors, pointing towards the complexity inherent in socio-economic dynamics.

-   Non-significance in certain racial categories may reflect data limitations or the presence of other variables not captured in the model, indicating areas where further research or data collection could be beneficial.


## 5. Enhanced Log-Log Regression Model with Interaction Terms 
### Model Overview

-  This model is built upon the foundation established in Section 3. This section explores nonlinearity further.

### Model Overview and Model Refinement:

-   The interaction term `EMPSTAT * FTOTINC` has been introduced to investigate the suspected interaction effect between employment status and total family income.
- But the p-value for `EMPSTATUnemployed:FTOTINC` is slightly above 0.05, suggesting it has borderline statistical significance. Therefore, adding interaction term needs to have further consideration.

### Statistical Performance:
```{r echo=FALSE, message=FALSE, warning=FALSE}
data_2022$FTOTINC = data_2022$FTOTINC - data_2022$INCTOT

log_model_2022 <- lm(log_RENTGRS ~ log_INCTOT + ROOMS + NFAMS + AGE + MARST + RACE + EMPSTAT*FTOTINC + REGION_CLASSIFIED, data = data_2022)
glance_log_model_2022 <- glance(log_model_2022)
kable(glance_log_model_2022)
```
-   All predictors show statistical significance, with the exception of certain categories within marital status and employment status.

-   The integration of the interaction term retains the significance of other variables, with no detrimental impact on the model’s variables as reflected in their p-values.

### Model Discussion:

- The residual plot indicates that the model without interaction terms performs better than the log-log regression with interaction terms. This residual plot does not show the performance as well as the section 3.

```{r echo=FALSE, message=FALSE, warning=FALSE}
residuals_2022 <- resid(log_model_2022)
fitted_values_2022 <- fitted(log_model_2022)

plot(fitted_values_2022, residuals_2022, 
     xlab = "Fitted Values", ylab = "Residuals",
     main = "Residual Plot", pch = 20)
abline(h = 0, col = "red") 
```

**Therefore, although this model's conclusions offer an extension to our understanding of the economic factors influencing rent prices in section 3, we still take the log_log model for further analysis.**

# Models and Inferences (Merged dataset)

## Outline

1.  Log-Log Regression Model by YEAR
2.  Longitudinal Log-Log Regression Model by Race
3.  Time series model

## 1. Log-Log Regression Model by YEAR

### Model Overview:

-   This analysis implements the validated Log-Log regression approach on annual data segments to assess temporal trends and variations.

### Model Findings:
```{r echo=FALSE, message=FALSE, warning=FALSE}
models_by_year <- data_twenty %>%
  group_by(YEAR) %>%
  nest() %>%
  mutate(
    model = map(data, ~ lm(log_RENTGRS ~ log_INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + RACE + EMPSTAT + REGION_CLASSIFIED, data = .)),
    tidied = map(model, tidy),
    glance_data = map(model, glance),
    augmented = map(model, augment)
  ) %>%
  ungroup()
models_by_year %>%
  unnest(tidied) %>%
  filter(term == "log_INCTOT") %>%
  ggplot(aes(x = as.numeric(YEAR), y = estimate)) +
  geom_line() +
  geom_point() +
  labs(title = "Trend of Coefficient for log_INCTOT Over Years",
       x = "Year",
       y = "Coefficient Estimate")
```

-   Observations show peaks in coefficient estimates, notably after 2000 and before 2020, with subsequent troughs suggesting potential corrective periods.

- The coefficient shows dropping down during the Covid-19 period.

-   The coefficient trend exhibits cyclicity with no monotonic progression, featuring multiple peaks and valleys, implying a potential cyclical influence on the income-rent relationship.

### Statistical Performance:

[Click here to view the summary table for the model of each Year.](https://yatingzhu.shinyapps.io/app3/)


-   All models are statistically validated, there is a noticeable exception in the MARSTSeparated category for the year 2022 shows to be statistically insiginificant, but others are all good .

-   R-squared values exhibit minor fluctuations over time, signifying a stable degree of explained variability in the response variable by the model.

-   P-values indicate consistent statistical significance for the model's predictors on an annual basis.

-   The trends in model deviance require additional context for clear interpretation, while a gradual decrease in df.residual suggests either an increase in model parameters or variations in data availability over time.

## 2. Longitudinal Log-Log Regression Model by Race

### Model Overview:
-   This model extended the 2022 dataset analysis to explore how the rent-income relationship for each racial group has evolved from 2000 to 2022.

### Model Findings:
[Click here to view the plot for the cofficients across Years for each race.](https://yatingzhu.shinyapps.io/app4/)

```{r echo=FALSE, message=FALSE, warning=FALSE}
categorical_vars <- c("KITCHEN", "MARST", "EMPSTAT", "REGION_CLASSIFIED")
data_twenty[categorical_vars] <- lapply(data_twenty[categorical_vars], factor)

categorical_vars <- c("KITCHEN", "MARST", "EMPSTAT", "REGION_CLASSIFIED")
data_twenty[categorical_vars] <- lapply(data_twenty[categorical_vars], factor)

race_levels <- data_twenty %>%
  group_by(RACE) %>%
  summarize(across(all_of(categorical_vars), ~n_distinct(.))) %>%
  ungroup()
races_with_single_levels <- race_levels %>%
  filter(if_any(everything(), ~.x == 1)) %>%
  pull(RACE) 
data_twenty_filtered <- data_twenty %>%
  filter(!RACE %in% races_with_single_levels)

data_twenty_filtered[categorical_vars] <- lapply(data_twenty_filtered[categorical_vars], factor)

race_year_levels <- data_twenty_filtered %>%
  group_by(RACE, YEAR) %>%
  summarize(across(all_of(categorical_vars), ~n_distinct(.))) %>%
  ungroup()

race_year_with_single_levels <- race_year_levels %>%
  filter(if_any(everything(), ~.x == 1)) 

data_twenty_filtered_final <- data_twenty_filtered %>%
  anti_join(race_year_with_single_levels, by = c("RACE", "YEAR"))

models_by_race_year <- data_twenty_filtered_final %>%
  group_by(RACE, YEAR) %>%
  do(
    model = lm(log_RENTGRS ~ log_INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + EMPSTAT + REGION_CLASSIFIED, data = .)
  )

models_with_coef <- models_by_race_year %>%
  rowwise() %>% 
  mutate(log_INCTOT_coef = coef(model)[["log_INCTOT"]]) %>%
  ungroup() %>%
  select(RACE, YEAR, log_INCTOT_coef)

coefficients_wide <- models_with_coef %>%
  pivot_wider(names_from = RACE, values_from = log_INCTOT_coef, names_prefix = "coef_")

log_inctot_p_values <- data_twenty %>%
  group_by(RACE, YEAR) %>%
  filter(if_all(c(KITCHEN, ROOMS, NFAMS, AGE, MARST, EMPSTAT, REGION_CLASSIFIED), ~n_distinct(.) > 1)) %>% # Ensure factors have more than one level
  do({
    safely_result = tryCatch({
      tidy(lm(log_RENTGRS ~ log_INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + EMPSTAT + REGION_CLASSIFIED, data = .))
    }, error = function(e) return(NULL))  # Handle any errors in lm
    
    if (!is.null(safely_result)) {
      safely_result
    } else {
      data.frame(YEAR = first(.$YEAR), RACE = first(.$RACE), term = NA, estimate = NA, p.value = NA)  # Placeholder for error groups
    }
  }) %>%
  ungroup() %>%
  filter(term == "log_INCTOT" & !is.na(estimate)) %>%
  select(RACE, YEAR, term, estimate, p.value)

unique_races <- unique(log_inctot_p_values$RACE)
```


**Alaska Native**: Shows minor fluctuations around zero, with both positive and negative coefficients, indicating inconsistent trends over the years.

**American**: This category has NA values, suggesting incomplete data, making it hard to discern a clear trend.

**Chinese**: Generally has higher positive coefficients compared to other groups, particularly noticeable in later years, indicating a strong positive association with income in those years.

**Japanese**: Has some missing values but otherwise presents mostly positive coefficients, with a notable spike in recent years.

**Islander**: Also features both positive and negative coefficients with considerable variability.

**Other race, nec**: Shows a mix of positive, negative, and NA values, making a clear trend difficult to establish.

**Two or more races**: This group generally has positive coefficients, with a few exceptions, suggesting a fairly consistent positive association with income.

**Whites**: Present a range of coefficients, mostly positive with some fluctuations, but generally indicate a positive association with income.


```{r echo=FALSE, message=FALSE, warning=FALSE}
coefficients_long <- coefficients_wide %>%
  pivot_longer(cols = -YEAR, names_to = "RACE", values_to = "log_INCTOT_coef")

unique_races <- unique(coefficients_long$RACE)

bar_color <- "#2C3E50" 
plots_list <- list()
for (race in unique_races) {
  race_data <- subset(coefficients_long, RACE == race)
  
  p <- ggplot(race_data, aes(x = as.factor(YEAR), y = log_INCTOT_coef)) +
    geom_bar(stat = "identity", fill = bar_color, width = 0.7) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=0.5), 
          plot.title = element_text(hjust = 0.5, face = "bold")) + 
    labs(title = paste("Income Coefficient:", race),
         x = "Year",
         y = "Coefficient")
  plots_list[[race]] <- p
}
coefficients_long <- coefficients_wide %>%
  pivot_longer(cols = -YEAR, names_to = "RACE", values_to = "log_INCTOT_coef")

unique_races <- unique(coefficients_long$RACE)

```

### Statistical Performance:
[Click here to view the summary table of each race across Years.](https://yatingzhu.shinyapps.io/app5/)
```{r echo=FALSE, message=FALSE, warning=FALSE}
data_twenty[categorical_vars] <- lapply(data_twenty[categorical_vars], factor)

# Filter out races with insufficient factor levels
race_levels <- data_twenty %>%
  group_by(RACE) %>%
  summarize(across(all_of(categorical_vars), ~n_distinct(.))) %>%
  ungroup()

races_with_single_levels <- race_levels %>%
  filter(if_any(everything(), ~.x == 1)) %>%
  pull(RACE)

data_twenty_filtered <- data_twenty %>%
  filter(!RACE %in% races_with_single_levels)
data_twenty_filtered[categorical_vars] <- lapply(data_twenty_filtered[categorical_vars], factor)

race_year_levels <- data_twenty_filtered %>%
  group_by(RACE, YEAR) %>%
  summarize(across(all_of(categorical_vars), ~n_distinct(.))) %>%
  ungroup()

race_year_with_single_levels <- race_year_levels %>%
  filter(if_any(everything(), ~.x == 1))

data_twenty_filtered_final <- data_twenty_filtered %>%
  anti_join(race_year_with_single_levels, by = c("RACE", "YEAR"))

models_by_race_year <- data_twenty_filtered_final %>%
  group_by(RACE, YEAR) %>%
  do({
    model = lm(log_RENTGRS ~ log_INCTOT + KITCHEN + ROOMS + NFAMS + AGE + MARST + EMPSTAT + REGION_CLASSIFIED, data = .)
    glance(model)
  }) %>%
  ungroup() %>%
  select(RACE, YEAR, everything())

unique_races <- unique(models_by_race_year$RACE)

```
- The p-value of 0 consistently across all races and years suggests that the models are statistically significant. This means the results are unlikely to have occurred by chance, and there is a statistically significant relationship between the dependent and independent variables in the models used.


## 3.Time series model
### Model Overview:
-  This time series model accounts for trends, and autocorrelation in data over time, which a simple regression model grouped by years might not capture by considering the time-dependent changes and patterns inherent in the data.

- Random Effects term introduces a random intercept for different regions (REGION_CLASSIFIED), allowing the model to account for variations in rent prices that are region-specific but not explained by the model's fixed effects.

### Model Findings:

[Click here to view the summary table, which includes estimates, standard errors and statistics for each coefficient.](https://yatingzhu.shinyapps.io/app7/)

```{r echo=FALSE, message=FALSE, warning=FALSE}
model_with_income_log <- lmer(log_RENTGRS ~ log_INCTOT + ROOMS + NFAMS + MARST + RACE + EMPSTAT + (1 | REGION_CLASSIFIED), data = data_twenty, REML = FALSE)
tidy_lm <- tidy(model_with_income_log)
```

- The model suggests that a 10% increase in income is predicted to raise rent by an average of 14.67%, with all other variables held constant, indicating income's elasticity effect on rent.

### Statistical performance:
- Most predictors have relatively low standard errors, suggesting a high degree of precision in the estimates. 

- Also, a statistic value in log_INCTOT is 83.46, suggesting that income is a highly significant predictor of rent. ROOMS and NFAMS have t-statistics of 76.24 and 35.64 respectively, indicating strong significance in predicting rent.

### Model discussion
#### Residual plot
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Calculate residuals and fitted values
residuals_twenty <- resid(model_with_income_log)
fitted_values_twenty <- fitted(model_with_income_log)

# Create a residual plot
plot(fitted_values_twenty, residuals_twenty, 
     xlab = "Fitted Values", ylab = "Residuals",
     main = "Residual Plot", pch = 20)
abline(h = 0, col = "red") 
```

- The residual plot indicates potential heteroscedasticity, as there is a clear pattern where the residuals spread increasingly around the zero line and become more negative as the fitted values increase. This suggests that the variance of the residuals is not constant, which could impact the reliability of the model's predictions at higher income levels.

- The pattern in this plot reflects the socio-economic dynamics of high-income individuals' housing decisions. 
  - As income significantly increases, people tend to purchase rather than rent homes, affecting the relationship between income and rental expenditures. This creates a ceiling effect on rental payments, leading to the model’s residuals deviating negatively from the expected line at higher income levels. 
  - Moreover, even the most expensive rental properties have a price cap, meaning that extremely wealthy individuals may rent homes within the same price range as those who are less affluent but still wealthy. This results in a scenario where, past a certain income threshold, further increases in income do not correspond to higher rents. 
  - Combined, these factors explain why the model’s residuals show such deviations at the upper income levels.

#### Q_Q plot
```{r echo=FALSE, message=FALSE, warning=FALSE}
residuals <- resid(model_with_income_log)

qqnorm(residuals, main = "Normal Q-Q Plot",
       xlab = "Theoretical Quantiles", ylab = "Sample Quantiles",
       pch = 16, 
       col = "black", 
       cex = 0.6) 
qqline(residuals, col = "blue", lwd = 2)  
abline(h = seq(-3, 3, 1), col = "gray", lty = 2)  
abline(v = seq(-3, 3, 1), col = "gray", lty = 2)

```
- The points mostly follow the line in the center, indicating that residuals are generally well-modeled. But the tails, especially the upper right, deviate from the line, suggesting the residuals have a distribution with more extreme values than a normal distribution would predict.

# Conclusion 

1. **Income and Rent Expenditure (2022):** Latest data indicates that a 10% increase in income is predicted to raise rent expenditure by approximately 13.34%, with other variables constant, showcasing the elastic nature of rent in response to changes in income.

2. **Time Effect and Autocorrelation Considerations:** When accounting for temporal effects and autocorrelation, a 10% increase in income is expected to lead to a 14.67% rise in rent, affirming the pronounced elasticity of rent costs relative to income fluctuations.

3. **Trends Over Years:** Analysis of yearly data reveals that coefficient estimates peaked notably between 2000 and 2020, followed by declines during the COVID-19 period, indicating cycles of increase and corrective adjustments in the relationship between income and rent.

4. **Racial and Ethnic Differences:** The association between income and rent varies significantly among racial and ethnic groups. Particularly, Chinese and Japanese groups have displayed a consistently strong positive relationship with income in recent years, highlighting disparities in economic outcomes across different demographics.

`The validity, limitations, and details of the models and statistical analysis used are thoroughly discussed in the respective sections above.`


